<div class="container mt-5 mb-5 d-flex justify-content-center">
    <div class="card shadow p-4" style="max-width: 700px; width: 100%;">
        
        <h3 class="mb-4 text-center text-primary fw-bold">
            {{ isEditMode ? 'Edit Room' : 'Create New Room' }}
        </h3>

        <form (ngSubmit)="save()" #roomForm="ngForm">
            
            <div class="mb-3">
                <label for="name" class="form-label fw-bold">Name</label>
                <input id="name" type="text" name="name" [(ngModel)]="room.name" class="form-control" required>
            </div>

            <div class="row">
                <div class="col-md-6 mb-3">
                    <label for="capacity" class="form-label fw-bold">Capacity</label>
                    <input id="capacity" type="number" name="capacity" [(ngModel)]="room.capacity" class="form-control" required>
                </div>

                <div class="col-md-6 mb-3">
                    <label for="camp" class="form-label fw-bold">Campus</label>
                    <select id="camp" name="camp" [(ngModel)]="room.camp" class="form-select">
                        <option *ngFor="let c of campusOptions" [value]="c">{{ c }}</option>
                    </select>
                </div>
            </div>

            <div class="mb-3">
                <label for="place" class="form-label fw-bold">Location</label>
                <input id="place" type="text" name="place" [(ngModel)]="room.place" class="form-control" required>
            </div>

            

            <div class="mb-4">
                <label for="softwareIds" class="form-label fw-bold">Installed Software</label>
                <select id="softwareIds" name="softwareIds" [(ngModel)]="room.softwareIds" class="form-select" multiple style="height: 150px;">
                    <option *ngFor="let soft of availableSoftware" [value]="soft.id">
                        {{ soft.name }} (v{{ soft.version }})
                    </option>
                </select>
                <small class="text-muted">Hold Ctrl (Windows) or Cmd (Mac) to select multiple options.</small>
            </div>

            <div class="mb-3">
                <label for="coordenades" class="form-label fw-bold">Coordinates (Optional)</label>
                <input id="coordenades" type="text" name="coordenades" [(ngModel)]="room.coordenades" class="form-control">
            </div>

            <div class="mb-3">
                <label class="form-label fw-bold">Room Image (Optional)</label>

                <div *ngIf="currentImageUrl" class="mb-2 p-2 border rounded bg-light d-flex align-items-center">
                    <img [src]="currentImageUrl" alt="Current Image" 
                         class="img-thumbnail me-3" 
                         style="height: 100px; width: 150px; object-fit: cover;">
                    <div>
                        <span class="badge bg-info text-dark mb-1">Current Image</span>
                        <p class="small text-muted mb-0">
                            Upload a new file below only if you want to replace this image.
                        </p>
                    </div>
                </div>

                <input type="file" (change)="onFileSelected($event)" accept="image/*" class="form-control">
                <small class="text-muted">Leave empty to keep current image (or default).</small>
            </div>
            
            <div class="card bg-light mb-4 border-0">
                <div class="card-body">
                    <div class="form-check form-switch">
                        <input class="form-check-input" type="checkbox" id="activeSwitch" name="active" [(ngModel)]="room.active">
                        <label class="form-check-label fw-bold" for="activeSwitch">
                            Enable Room
                        </label>
                    </div>
                    <div *ngIf="!room.active" class="alert alert-warning mt-2 mb-0 d-flex align-items-center">
                        <i class="fa fa-exclamation-triangle me-2"></i>
                        <small>
                            <strong>Warning:</strong> Disabling this room will automatically cancel any future reservations associated with it.
                        </small>
                    </div>
                </div>
            </div>

            <div class="d-flex justify-content-between pt-3 border-top">
                <button type="button" class="btn btn-outline-secondary" routerLink="/admin/rooms">Cancel</button>
                <button type="submit" class="btn btn-success px-4" [disabled]="!roomForm.form.valid">
                    <i class="fa fa-save"></i> {{ isEditMode ? 'Update' : 'Save' }}
                </button>
            </div>

        </form>
    </div>
</div>